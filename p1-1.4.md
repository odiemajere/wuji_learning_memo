# C51点亮第一个led灯
## 任务：
- 点亮无线门磁探测器模块的LED1和LED2

## 准备：

- 无线门磁模块（STC15W104）
- 烧录器（ST-link）
- 数字电源
- PC主机（安装KEIL C51）

## 流程：

    1. 安装KEIL C51并破解
    2. 安装USB-串口驱动程序（本课使用ch340）
    3. 使用STC-ISP软件将STC系列芯片的头文件添加到KEIL库中
    4. 运行KEIL，
        - 新建project，命名为LED
        - 新建main.c文件到工程LED的文件夹内
        - 右键点击Source Group 选择add existing file to ‘Source Group 1’将main.c文件添加到工程里
        - 现在开始编辑main.c文件
            * 输入

            void main(void)
            {
	                systeminit();	
	                while(1)
	            {  ...
	            }
            }

            * 右键添加头文件 #include <STC15.H>
            * 本节所用芯片为STC15W04，没有严格对应的头文件。本芯片为STC15系列芯片，可以用通用头文件STC15.H
            * 在options for target内选择生成.hex文件并对所生成的文件命名
            * 点击build
        - 在objects文件夹内找到相应的.hex文件
    5. 运行STC-ISP程序
        - 选择芯片型号STC15W104
        - 选择串口（上述第2步中的串口端口）
        - 选择 输入用户程序运行时的IRC频率为5.5296MHz（本次模块的运行频率）
        - 点击 打开程序文件，选择第4步生成的.hex文件
    6. 用USB-串口线连接电脑与单片机对应端口GND-GND TXD-RXD RXD-TXD 5V-VCC
    7. 在STC-ISP内点击“下载/编程”->用数字电源给单片机供电（此处给出6v供电，这叫做冷启动烧录，指烧录程序的时候先断电，启动软件进入烧录状态，然后再给设备供电）
    8. 看一下无线门磁探测器模块的原理图，发现led1与p3.1相连，led2与p3.0相连。
    9. 在KEIL内编辑main.c
        * 首先在void main(void){}外面定义两个端口
        * sbit LED1 = P3^1;
        * sbit LED2 = P3^0;
        * 然后在void main(void){}内部给LED1和LED2赋值，0为灭灯，1为点亮灯

## 小结：
- C语言源程序->C编译器->汇编代码->汇编器->机器代码(.hex  .bin)
- 单片机可以识别的文件类型为.hex或.bin

- 而在C语言程序中 main函数，又是程序执行的起点，是所有程序运行的入口

```C
#include <STC15.H>
sbit LED1 = P3^1;
sbit LED2 = P3^0;

//高低电平
//低电平		GND		0V
//高电平		VCC		单片机的VCC 供电电压
//单片机的普通IO只能输出高电平或低电平
//IO = 0		输出低电平		0V
//IO = 1		输出高电平		VCC

void main(void)
{
	LED1 = 1;//0为低电平，灭灯。1为高电平，亮灯
	LED2 = 1;
	while(1);
}
```